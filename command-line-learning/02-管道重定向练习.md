# 🔗 管道和重定向 - 第二阶段

现在你已经掌握了基本的文本处理命令，让我们学习如何将它们组合起来，发挥更大的威力！

## 🎯 本阶段目标
学会使用管道（|）和重定向（>, >>）来组合命令和处理输出。

## 核心概念详解

### 1. 管道 (|) - 命令的桥梁
管道可以将一个命令的输出作为另一个命令的输入。

```bash
# 基础语法
命令1 | 命令2 | 命令3

# 实际例子
ls -l | grep ".txt"              # 只显示txt文件
cat 文件名 | grep "关键词"        # 在文件中搜索关键词
ps aux | grep "进程名"           # 查找特定进程
```

### 2. 输出重定向 (>) - 保存结果
```bash
# 覆盖写入文件
命令 > 文件名                    # 将输出保存到文件（覆盖原内容）
ls > 文件列表.txt               # 将文件列表保存到文件

# 追加到文件
命令 >> 文件名                   # 将输出追加到文件末尾
echo "新内容" >> 日志.txt       # 在文件末尾添加内容
```

### 3. 输入重定向 (<) - 从文件读取
```bash
# 从文件读取输入
命令 < 文件名
sort < 待排序.txt              # 对文件内容排序
```

### 4. 错误重定向 (2>) - 处理错误信息
```bash
命令 2> 错误日志.txt            # 将错误信息保存到文件
命令 > 输出.txt 2> 错误.txt    # 分别保存正常输出和错误信息
命令 &> 全部.txt               # 将所有输出保存到一个文件
```

## 🏃‍♂️ 实践练习

### 练习1：基础管道操作
```bash
cd practice-area-advanced

# 查找包含特定内容的文件
ls | grep ".txt"                        # 只显示txt文件
cat data/students.txt | grep "张"       # 查找姓张的学生
cat logs/app.log | grep "ERROR" | wc -l # 统计错误数量
```

### 练习2：复杂的管道组合
```bash
# 找出最常见的错误类型
cat logs/app.log | grep "ERROR" | sort | uniq -c | sort -nr

# 查找文件中最长的行
cat data/essay.txt | wc -L

# 统计每个单词出现的次数
cat data/essay.txt | tr ' ' '\n' | sort | uniq -c | sort -nr
```

### 练习3：输出重定向
```bash
# 保存搜索结果
grep "张" data/students.txt > 姓张学生.txt
ls -l > 文件详情.txt

# 追加内容
echo "新增学生：李明" >> data/students.txt
date >> 操作日志.txt
```

### 练习4：创建报告
```bash
# 生成系统报告
echo "=== 系统报告 ===" > 系统报告.txt
echo "生成时间：$(date)" >> 系统报告.txt
echo "" >> 系统报告.txt
echo "文件统计：" >> 系统报告.txt
ls | wc -l >> 系统报告.txt
echo "磁盘使用：" >> 系统报告.txt
df -h >> 系统报告.txt
```

## 🔥 高级技巧

### 1. tee命令 - 同时显示和保存
```bash
# 既在屏幕显示又保存到文件
ls -l | tee 文件列表.txt
cat 文件名 | grep "关键词" | tee 搜索结果.txt
```

### 2. 多重管道
```bash
# 复杂的数据处理流水线
cat data/sales.txt | grep "2024" | sort | uniq | wc -l
```

### 3. 条件执行
```bash
# 命令成功后执行下一个
命令1 && 命令2                  # 命令1成功才执行命令2
命令1 || 命令2                  # 命令1失败才执行命令2
```

## 💡 实用场景

### 日志分析
```bash
# 分析访问日志
cat access.log | grep "404" | wc -l                    # 统计404错误
cat access.log | cut -d' ' -f1 | sort | uniq -c       # 统计IP访问次数
```

### 数据处理
```bash
# 处理CSV文件
cat data.csv | cut -d',' -f2 | sort | uniq            # 提取第二列并去重
```

### 系统监控
```bash
# 监控系统状态
ps aux | grep "python" | wc -l                        # 统计Python进程数
```

## 🎯 掌握标准
完成本阶段后，你应该能够：
- 熟练使用管道组合多个命令
- 将命令输出保存到文件
- 创建复杂的数据处理流水线
- 生成自动化报告

## 下一步
接下来我们将学习系统监控，了解如何查看和管理系统资源！
